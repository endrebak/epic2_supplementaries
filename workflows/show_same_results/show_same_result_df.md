
# epic2-df and sicer-df give the same results

To test that the differential version of epic2 gives the same results as
SICER-df and SICER-rb-df we have tested it on two datasets, the original one
that came with SICER and the Satrom H3K27me3 and H3K4me3.

See the description of the non-differential version for the parameters used. In
addition we used an FDR-cutoff of 1 for the differntial p-values to ensure that
even the non-enriched versions were the same.

# Test 1: canonical SICER example data

SICER gives 214 regions as does epic2. The SICER and epic2-df islands have the
same scores:

#### epic2-df

```
#Chromosome	Start	End	KO_Count	WT_Count	KO_FC	WT_FC	FDR_WT	FDR_KO
chr1	100589600	100589799	2	0	2.8143893591293834	0.3553168635875402	1.0	0.23124431416649688
chr1	103840400	103841199	2	0	2.8143893591293834	0.3553168635875402	1.0	0.23124431416649688
chr1	113416400	113416799	2	0	2.8143893591293834	0.3553168635875402	1.0	0.23124431416649688
chr1	113486600	113487199	2	0	2.8143893591293834	0.3553168635875402	1.0	0.23124431416649688
chr1	115014800	115014999	2	0	2.8143893591293834	0.3553168635875402	1.0	0.23124431416649688
chr1	121186200	121186999	0	3	0.2345324465941153	4.263802363050483	1.0	1.0
chr1	144181400	144181999	2	0	2.8143893591293834	0.3553168635875402	1.0	0.23124431416649688
chr1	160736400	160736999	0	2	0.3127099287921537	3.197851772287862	0.8069954637238973	1.0
chr1	171053400	171054599	3	0	3.7525191455058446	0.2664876476906552	1.0	1.0
```

#### SICER-rb-df

```
#chrom  start   end     Readcount_A     Normalized_Readcount_A  ReadcountB      Normalized_Readcount_B  Fc_A_vs_B       pvalue_A_vs_B   FDR_A_vs_B      Fc_B_vs_A       pvalue_B_vs_A   FDR_B_vs_A
chr1    100589600       100589799       2       201.531640468   0       0.0     2.81438935913   0.09282342188373466     0.23124431416649688     0.355316863588  1       1
chr1    103840400       103841199       2       201.531640468   0       0.0     2.81438935913   0.09282342188373466     0.23124431416649688     0.355316863588  1       1
chr1    113416400       113416799       2       201.531640468   0       0.0     2.81438935913   0.09282342188373466     0.23124431416649688     0.355316863588  1       1
chr1    113486600       113487199       2       201.531640468   0       0.0     2.81438935913   0.09282342188373466     0.23124431416649688     0.355316863588  1       1
chr1    115014800       115014999       2       201.531640468   0       0.0     2.81438935913   0.09282342188373466     0.23124431416649688     0.355316863588  1       1
chr1    121186200       121186999       0       0.0     3       322.234156821   0.234532446594  1       1       4.26380236305   0.01542682567759998     1
chr1    144181400       144181999       2       201.531640468   0       0.0     2.81438935913   0.09282342188373466     0.23124431416649688     0.355316863588  1       1
chr1    160736400       160736999       0       0.0     2       214.822771214   0.312709928792  1       1       3.19785177229   0.06928020197130445     0.6023135926484836
chr1    171053400       171054599       3       302.297460701   0       0.0     3.75251914551   0.023301220730559374    1       0.266487647691  1       1
```

# Test 2: H3K27me3 vs H3K4me3 with input

Both epic2-df and SICER-df give 56194 regions. They are the same:


#### epic2-df

```
#Chromosome	Start	End	KO_Count	WT_Count	KO_FC	WT_FC	FDR_WT	FDR_KO
chr1	10000	10599	17	0	60.67149127731108	0.016482205710575033	1.0	2.117583009930148e-25
chr1	28000	30399	107	0	364.02894766386646	0.0027470342850958386	1.0	1.7245582576466815e-230
chr1	36600	51399	37	375	0.3406496259659901	2.935567585504522	0.0	1.0
chr1	52200	71999	0	538	0.006253503533014954	159.91035980399897	0.0	1.0
chr1	78000	78599	9	0	33.706384042950596	0.02966797027903506	1.0	5.0780679845200706e-12
chr1	79800	82199	0	59	0.056177306738251	17.800782167421037	1.6403893360003098e-113	1.0
chr1	89000	90799	0	22	0.14654949583891563	6.823633164178064	3.548152837212578e-35	1.0
chr1	92000	93799	0	43	0.07660541827943318	13.053906922775427	8.001130259043389e-78	1.0
chr1	94600	97599	0	51	0.06481996931336655	15.427344545098231	2.1362714184047138e-95	1.0
```

#### SICER-df

```
#chrom  start   end     Readcount_A     Normalized_Readcount_A  ReadcountB      Normalized_Readcount_B  Fc_A_vs_B       pvalue_A_vs_B   FDR_A_vs_B      Fc_B_vs_A       pvalue_B_vs_A   FDR_B_vs_A
chr1    10000   10599   9       0.76667544652   17      4.88127168038   0.164820975983  1       1       6.06718892445   5.98070918535218e-10    2.991579056903107e-09
chr1    28000   30399   4       0.340744642898  107     30.7232982236   0.0137350813319 1       1       72.8062670934   2.491901240238865e-167  1.0034210418684524e-165
chr1    36600   51399   375     31.9448102717   79      22.6835566324   1.39438545681   1.4025645686686852e-10  4.0473635704410943e-10  0.717161811401  1       1
chr1    52200   71999   538     45.8301544698   91      26.1291601715   1.73814468368   3.214479307984196e-33   8.768506589978442e-32   0.575326098794  1       1
chr1    78000   78599   10      0.851861607245  9       2.58420265432   0.326345532446  1       1       3.06423683053   0.001015702302248941    0.004145357843648527
chr1    79800   82199   59      5.02598348274   4       1.14853451303   3.56013308123   1.3146602725124271e-20  1.1507859598612169e-19  0.280888376132  1       1
chr1    89000   90799   22      1.87409553594   3       0.861400884774  1.70589710142   0.0003441246536339685   0.0005608944384978998   0.586201828449  1       1
chr1    92000   93799   43      3.66300491115   4       1.14853451303   2.61076425957   3.828889143246739e-11   1.1958468631973322e-10  0.383029603816  1       1
chr1    94600   97599   51      4.34449419695   11      3.15846991084   1.28560361267   0.0118631204940751      0.01743834490677031     0.777844733904  1       1
```
